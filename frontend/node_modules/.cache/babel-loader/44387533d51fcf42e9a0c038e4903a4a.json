{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jacksonthounaojam/Downloads/student/Web devop/React/project/twitter-clone/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jacksonthounaojam/Downloads/student/Web devop/React/project/twitter-clone/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import Axios from\"axios\";function login(_x,_x2){return _login.apply(this,arguments);}function _login(){_login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(email,pwd){var res,_yield$res,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Axios.post(\"/api/login\",{email:email,pwd:pwd});case 2:res=_context.sent;_context.next=5;return res;case 5:_yield$res=_context.sent;data=_yield$res.data;if(!data.error){_context.next=11;break;}return _context.abrupt(\"return\",data.error);case 11:localStorage.setItem(\"token\",data.token);localStorage.setItem(\"refreshToken\",data.refreshToken);return _context.abrupt(\"return\",true);case 14:case\"end\":return _context.stop();}}},_callee);}));return _login.apply(this,arguments);}function check(){return _check.apply(this,arguments);}function _check(){_check=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var token,res,_yield$res2,data,refresh_token;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:token=localStorage.getItem(\"token\");_context2.prev=1;_context2.next=4;return Axios.post(\"/api/checkiftokenexpire\",{},{headers:{Authorization:\"Bearer \"+token}});case 4:res=_context2.sent;_context2.next=7;return res;case 7:_yield$res2=_context2.sent;data=_yield$res2.data;return _context2.abrupt(\"return\",data.success);case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](1);console.log(\"p\");refresh_token=localStorage.getItem(\"refreshToken\");if(refresh_token){_context2.next=19;break;}localStorage.removeItem(\"token\");return _context2.abrupt(\"return\",false);case 19:Axios.post(\"/api/refreshtoken\",{},{headers:{Authorization:\"Bearer \".concat(refresh_token)}}).then(function(res){localStorage.setItem(\"token\",res.data.token);});return _context2.abrupt(\"return\",true);case 21:case\"end\":return _context2.stop();}}},_callee2,null,[[1,12]]);}));return _check.apply(this,arguments);}function logout(){if(localStorage.getItem(\"token\")){var token=localStorage.getItem(\"token\");Axios.post(\"/api/logout/access\",{},{headers:{Authorization:\"Bearer \".concat(token)}}).then(function(res){if(res.data.error){console.error(res.data.error);}else{localStorage.removeItem(\"token\");}});}if(localStorage.getItem(\"refreshToken\")){var refreshToken=localStorage.getItem(\"refreshToken\");Axios.post(\"/api/logout/refresh\",{},{headers:{Authorization:\"Bearer \".concat(refreshToken)}}).then(function(res){if(res.data.error){console.error(res.data.error);}else{localStorage.removeItem(\"refreshToken\");}});}localStorage.clear();setTimeout(function(){return window.location=\"/\";},500);}export{login,check,logout};","map":{"version":3,"sources":["/Users/jacksonthounaojam/Downloads/student/Web devop/React/project/twitter-clone/frontend/src/login.js"],"names":["Axios","login","email","pwd","post","res","data","error","localStorage","setItem","token","refreshToken","check","getItem","headers","Authorization","success","console","log","refresh_token","removeItem","then","logout","clear","setTimeout","window","location"],"mappings":"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","sourcesContent":["import Axios from \"axios\";\n\nasync function login(email, pwd) {\n    const res = await Axios.post(\"/api/login\", {email, pwd});\n    const {data} = await res;\n    if (data.error) {\n        return data.error\n    } else {\n        localStorage.setItem(\"token\", data.token);\n        localStorage.setItem(\"refreshToken\", data.refreshToken);\n        return true\n    }\n}\n\nasync function check() {\n    const token = localStorage.getItem(\"token\")\n    try {\n        const res = await Axios.post(\"/api/checkiftokenexpire\", {}, {\n            headers: {\n                Authorization: \"Bearer \" + token\n            }\n        })\n        const {data} = await res;\n        return data.success\n    } catch {\n        console.log(\"p\")\n        const refresh_token = localStorage.getItem(\"refreshToken\")\n        if (!refresh_token) {\n            localStorage.removeItem(\"token\")\n            return false;\n        }\n        Axios.post(\"/api/refreshtoken\", {}, {\n            headers: {\n                Authorization: `Bearer ${refresh_token}`\n            }\n        }).then(res => {\n            localStorage.setItem(\"token\", res.data.token)\n        })\n        return true;\n    }\n}\n\nfunction logout() {\n    if (localStorage.getItem(\"token\")) {\n        const token = localStorage.getItem(\"token\")\n        Axios.post(\"/api/logout/access\", {}, {\n            headers: {\n                Authorization: `Bearer ${token}`\n            }\n        }).then(res => {\n            if (res.data.error) {\n                console.error(res.data.error)\n            } else {\n                localStorage.removeItem(\"token\")\n            }\n        })\n    }\n    if (localStorage.getItem(\"refreshToken\")) {\n        const refreshToken = localStorage.getItem(\"refreshToken\")\n        Axios.post(\"/api/logout/refresh\", {}, {\n            headers: {\n                Authorization: `Bearer ${refreshToken}`\n            }\n        }).then(res => {\n            if (res.data.error) {\n                console.error(res.data.error)\n            } else {\n                localStorage.removeItem(\"refreshToken\")\n            }\n        })\n    }\n    localStorage.clear();\n    setTimeout(() => window.location = \"/\", 500)\n}\n\nexport {login, check, logout};"]},"metadata":{},"sourceType":"module"}