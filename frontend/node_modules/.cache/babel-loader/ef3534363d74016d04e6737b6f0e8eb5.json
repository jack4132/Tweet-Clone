{"ast":null,"code":"import Axios from \"axios\";\n\nasync function login(email, pwd) {\n  const res = await Axios.post(\"/api/login\", {\n    email,\n    pwd\n  });\n  const {\n    data\n  } = await res;\n\n  if (data.error) {\n    return data.error;\n  } else {\n    localStorage.setItem(\"token\", data.token);\n    localStorage.setItem(\"refreshToken\", data.refreshToken);\n    return true;\n  }\n}\n\nasync function check() {\n  const token = localStorage.getItem(\"token\");\n\n  try {\n    const res = await Axios.post(\"/api/checkiftokenexpire\", {}, {\n      headers: {\n        Authorization: \"Bearer \" + token\n      }\n    });\n    const {\n      data\n    } = await res;\n    return data.success;\n  } catch {\n    console.log(\"p\");\n    const refresh_token = localStorage.getItem(\"refreshToken\");\n\n    if (!refresh_token) {\n      localStorage.removeItem(\"token\");\n      return false;\n    }\n\n    Axios.post(\"/api/refreshtoken\", {}, {\n      headers: {\n        Authorization: `Bearer ${refresh_token}`\n      }\n    }).then(res => {\n      localStorage.setItem(\"token\", res.data.token);\n    });\n    return true;\n  }\n}\n\nfunction logout() {\n  if (localStorage.getItem(\"token\")) {\n    const token = localStorage.getItem(\"token\");\n    Axios.post(\"/api/logout/access\", {}, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(res => {\n      if (res.data.error) {\n        console.error(res.data.error);\n      } else {\n        localStorage.removeItem(\"token\");\n      }\n    });\n  }\n\n  if (localStorage.getItem(\"refreshToken\")) {\n    const refreshToken = localStorage.getItem(\"refreshToken\");\n    Axios.post(\"/api/logout/refresh\", {}, {\n      headers: {\n        Authorization: `Bearer ${refreshToken}`\n      }\n    }).then(res => {\n      if (res.data.error) {\n        console.error(res.data.error);\n      } else {\n        localStorage.removeItem(\"refreshToken\");\n      }\n    });\n  }\n\n  localStorage.clear();\n  setTimeout(() => window.location = \"/\", 500);\n}\n\nexport { login, check, logout };","map":{"version":3,"sources":["/Users/jacksonthounaojam/Downloads/student/Web devop/React/project/twitter-clone/frontend/src/login.js"],"names":["Axios","login","email","pwd","res","post","data","error","localStorage","setItem","token","refreshToken","check","getItem","headers","Authorization","success","console","log","refresh_token","removeItem","then","logout","clear","setTimeout","window","location"],"mappings":"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","sourcesContent":["import Axios from \"axios\";\n\nasync function login(email, pwd) {\n    const res = await Axios.post(\"/api/login\", {email, pwd});\n    const {data} = await res;\n    if (data.error) {\n        return data.error\n    } else {\n        localStorage.setItem(\"token\", data.token);\n        localStorage.setItem(\"refreshToken\", data.refreshToken);\n        return true\n    }\n}\n\nasync function check() {\n    const token = localStorage.getItem(\"token\")\n    try {\n        const res = await Axios.post(\"/api/checkiftokenexpire\", {}, {\n            headers: {\n                Authorization: \"Bearer \" + token\n            }\n        })\n        const {data} = await res;\n        return data.success\n    } catch {\n        console.log(\"p\")\n        const refresh_token = localStorage.getItem(\"refreshToken\")\n        if (!refresh_token) {\n            localStorage.removeItem(\"token\")\n            return false;\n        }\n        Axios.post(\"/api/refreshtoken\", {}, {\n            headers: {\n                Authorization: `Bearer ${refresh_token}`\n            }\n        }).then(res => {\n            localStorage.setItem(\"token\", res.data.token)\n        })\n        return true;\n    }\n}\n\nfunction logout() {\n    if (localStorage.getItem(\"token\")) {\n        const token = localStorage.getItem(\"token\")\n        Axios.post(\"/api/logout/access\", {}, {\n            headers: {\n                Authorization: `Bearer ${token}`\n            }\n        }).then(res => {\n            if (res.data.error) {\n                console.error(res.data.error)\n            } else {\n                localStorage.removeItem(\"token\")\n            }\n        })\n    }\n    if (localStorage.getItem(\"refreshToken\")) {\n        const refreshToken = localStorage.getItem(\"refreshToken\")\n        Axios.post(\"/api/logout/refresh\", {}, {\n            headers: {\n                Authorization: `Bearer ${refreshToken}`\n            }\n        }).then(res => {\n            if (res.data.error) {\n                console.error(res.data.error)\n            } else {\n                localStorage.removeItem(\"refreshToken\")\n            }\n        })\n    }\n    localStorage.clear();\n    setTimeout(() => window.location = \"/\", 500)\n}\n\nexport {login, check, logout};"]},"metadata":{},"sourceType":"module"}